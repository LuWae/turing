add

[state1] {
  |0 $1<[state2]
  |_ $xff
  |x22 >
  |1 > {
    |0 $2
    @ $3 {
      0| $4
      @ [move_right]
    }
  }
  ?a-z >
  #comment
}

[move_right] {
  |_ <[move_left]
  @  >
}

[move_left] {
  |0 $1[]
  |_ $1[]
  ?0-9a-z?
  |1 <
}

NAME

STATE LCURLY
  SYMDEF SYM LMOVE STATE
  SYMDEF SYM
  SYMDEF RMOVE
  SYMDEF RMOVE LCURLY
    SYMDEF SYM
    WILDDEF SYM LCURLY
      SYMDEF SYM
      WILDDEF STATE
    RCURLY
  RCURLY
  MATCHDEF RMOVE
  COMMENT
RCURLY

S -> NAME STATELIST
STATELIST -> STATEDEF STATELIST | eps
STATEDEF -> STATE STATEBODY
STATEBODY -> LCURLY SYMDEFLIST RCURLY
SYMDEFLIST -> SINGLE_SYMDEF SYMDEFLIST | eps
SINGLE_SYMDEF -> SYMDEF SYMDEF_DESC | MATCHDEF SYMDEF_DESC | WILDDEF SYMDEF_DESC
SYMDEF_DESC -> SSYM MOVE ALT
SSYM -> SYM | eps
ALT -> STATEBODY | STATE | eps
MOVE -> LMOVE | RMOVE | eps


S
NAME STATELIST
NAME STATEDEF STATELIST
NAME STATEDEF STATELIST
NAME STATE STATEBODY STATELIST
NAME STATE LCURLY SYMDEFLIST RCURLY STATELIST
NAME STATE LCURLY SINGLE_SYMDEF SYMDEFLIST RCURLY STATELIST
NAME STATE LCURLY MATCHDEF SYMDEF_DESC SYMDEFLIST RCURLY STATELIST
NAME STATE LCURLY MATCHDEF SSYM MOVE ALT SYMDEFLIST RCURLY STATELIST
NAME STATE LCURLY MATCHDEF SYM MOVE ALT SYMDEFLIST RCURLY STATELIST
NAME STATE LCURLY MATCHDEF SYM LMOVE ALT SYMDEFLIST RCURLY STATELIST
NAME STATE LCURLY MATCHDEF SYM LMOVE STATE SYMDEFLIST RCURLY STATELIST
NAME STATE LCURLY MATCHDEF SYM LMOVE STATE SINGLE_SYMDEF SYMDEFLIST RCURLY STATELIST
NAME STATE LCURLY MATCHDEF SYM LMOVE STATE WILDDEF SYMDEF_DESC SYMDEFLIST RCURLY STATELIST
NAME STATE LCURLY MATCHDEF SYM LMOVE STATE WILDDEF SSYM MOVE ALT SYMDEFLIST RCURLY STATELIST
NAME STATE LCURLY MATCHDEF SYM LMOVE STATE WILDDEF MOVE ALT SYMDEFLIST RCURLY STATELIST
NAME STATE LCURLY MATCHDEF SYM LMOVE STATE WILDDEF ALT SYMDEFLIST RCURLY STATELIST
NAME STATE LCURLY MATCHDEF SYM LMOVE STATE WILDDEF STATE SYMDEFLIST RCURLY STATELIST
NAME STATE LCURLY MATCHDEF SYM LMOVE STATE WILDDEF STATE RCURLY STATELIST
...


user needs to escape some chars
escaping too much is not nice! not something like x, only control symbols
double-pass for naming

default
 - char: same as before
 - move: none
 - statechange: same as before
note: infinite loop (same char, no move, same state) is taken as STOP

S  = [(a-zA-Z0-9_)*]
CL = {
CR = }
D  = |(.) oder |x(0-9a-f)(0-9a-f)
C  = $(.) oder $x(0-9a-f)(0-9a-f)
M  = < oder >
CM = # (.)* \n
